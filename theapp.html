<!-- This is the HTML part -->
<form>
  <label for="image-input">Select an image:</label>
  <input type="file" id="image-input" name="image-input" accept=".png,.jpeg,.jpg,.gif,.bmp">
  <input type="submit" id="submit-button" value="Submit">
</form>
<!-- This is where the output image will be shown -->
<img id="output-image" alt="Output image">
<!-- This is the JavaScript part -->
<script>
  // get your token from https://replicate.com/account
  const token = "9876b5f71cafb8fa758cafb8895d6e4d3d69ca80";
  // get the form element
  const form = document.querySelector("form");
  // get the image element
  const outputImage = document.getElementById("output-image");
  // add an event listener for when the user submits the form
  form.addEventListener("submit", function(event) {
    // prevent the default form submission behavior
    event.preventDefault();
    // get the selected file
    const file = form.elements["image-input"].files[0];
    // create a FormData object to send the file
    const formData = new FormData();
    formData.append("input", file);
    // run a model and await the result
    const model = "nightmareai/real-esrgan";
    // create a FormData object to send the file
    const formData2 = new FormData();
    formData2.append("input", file);

    // add the input image scale setting
    formData2.append("input_image_scale", 2);

    // add the face enhance setting
    formData2.append("face_enhance", true);
    // make a POST request to the Replicate API
    fetch(`https://cors-anywhere.herokuapp.com/https://api.replicate.com/v1/models/${model}/run`, {
  method: "POST",
  headers: {
    "Authorization": `Bearer ${token}`,
    "Content-Type": "multipart/form-data",
    "x-requested-with": "XMLHttpRequest"
  },
  body: formData
})
.then(response => {
  // check if the response is ok
  if (response.ok) {
    // return the response as a blob
    return response.blob();
  } else {
    // throw an error with the status text
    throw new Error(response.statusText);
  }
})
.then(blob => {
  // create a URL for the blob
  const url = URL.createObjectURL(blob);
  // set the image source to the URL
  outputImage.src = url;
})
.catch(error => {
  // log the error to the console
  console.error(error);
});
    }).then(response => response.json()).then(data => {
      // data is an object with an output property
      // set the image source to the output URL
      outputImage.src = data.output[0];
    });
</script>